<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <title>Chat E-commerce (simple)</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 720px; margin: 2rem auto; }
    #log { border: 1px solid #ddd; padding: 1rem; height: 360px; overflow: auto; white-space: pre-wrap; }
    .me { color: #0b5; } .bot { color: #06c; }
  </style>
</head>
<body>
  <h1>Chat E-commerce (simple)</h1>
  <div id="log"></div>
  <div style="margin-top:1rem;">
    <input id="msg" placeholder="Escribe aquÃ­..." style="width:80%"/>
    <button id="send">Enviar</button>
  </div>
  <script>
    const BOT_BASE = "http://localhost:9000";
    const log = document.getElementById("log");
    const input = document.getElementById("msg");
    const btn = document.getElementById("send");
    function add(text, cls){ const p = document.createElement("div"); p.className = cls; p.textContent = text; log.appendChild(p); log.scrollTop = log.scrollHeight; }
    async function send(){
      const text = input.value.trim(); if(!text) return;
      add(text, "me"); input.value="";
      try {
        const r = await fetch(BOT_BASE + "/reply", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({message: text, user_id: 1})
        });
        const data = await r.json();
        add(data.reply || "(sin respuesta)", "bot");
      } catch (e) {
        add("Error conectando al bot: " + e, "bot");
      }
    }
    btn.onclick = send;
    input.addEventListener("keydown", (e)=>{ if(e.key==="Enter") send(); });
  </script>
</body>
</html>